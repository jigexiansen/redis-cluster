# 🏗️ Redis Cluster 架构说明

## 🔗 集群架构

Redis Cluster自动将数据分片到16384个槽位，在6个节点间分布：

- **3个主节点** (7000, 7001, 7002) - 负责数据写入和分片
- **3个从节点** (7003, 7004, 7005) - 提供高可用和读取分流

## ✨ 核心优势

- 📊 **数据分片** - 16384个槽位自动分配
- 🛡️ **故障转移** - 主节点宕机时从节点自动接管  
- ⚖️ **负载均衡** - 读写请求智能路由
- 📈 **在线扩容** - 支持动态添加/删除节点
- 🔒 **强一致性** - 分布式一致性保证

## 🔧 技术栈

### 🐳 Bitnami Redis Cluster镜像
- **版本**: bitnami/redis-cluster:7.4
- **特性**: 自动集群初始化，无需手动配置
- **优化**: 内置生产级配置

### 🌐 网络配置
- **网络**: redis-cluster-network (172.20.0.0/16)
- **服务发现**: 容器间DNS自动解析
- **端口映射**: 7000-7005 + 集群总线17000-17005

## 🎯 组件说明

### Redis Cluster节点
6个Redis实例组成集群，自动分配主从关系和槽位分布

### Redis Insight
官方Web管理界面，提供集群监控和管理功能

### Redis Exporter  
Prometheus指标导出器，用于监控集群状态和性能

## 🔍 数据流

1. **写入请求** → 自动路由到对应槽位的主节点
2. **读取请求** → 可从主节点或从节点读取
3. **故障检测** → 集群自动检测节点状态
4. **故障转移** → 从节点自动提升为主节点

## 📊 槽位分配

- 槽位0-5460: redis-node-0 (主) ↔ redis-node-3 (从)
- 槽位5461-10922: redis-node-1 (主) ↔ redis-node-4 (从)  
- 槽位10923-16383: redis-node-2 (主) ↔ redis-node-5 (从)